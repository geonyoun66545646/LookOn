<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org/"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{customer/layout/layoutMain}">
    <head>
        <title>Î¨∏Ïùò Í≤åÏãúÌåê</title>
        <th:block layout:fragment="customCss">
            <link rel="stylesheet" th:href="@{/maincss/assets/customcustomercss/inquiryListView.css}">
        </th:block>
    </head>
    <body>
        <th:block layout:fragment="contents">
            <main class="main">
                <div class="page-header text-center" style="background-image: url('assets/images/page-header-bg.jpg')">
                    <div class="container">
                        <h1 class="page-title">INQUIRYES<span>Î¨∏Ïùò & ÎãµÎ≥Ä</span></h1>
                    </div>
                </div>
                <nav aria-label="breadcrumb" class="breadcrumb-nav">
                    <div class="container">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a th:href="@{/}">Home</a></li>
                            <li class="breadcrumb-item"><a th:href="@{/customer/inquiry/FAQ}">FAQ</a></li>
                            <li class="breadcrumb-item">
                                <a th:href="@{/customer/inquiry/inquiryList}">INQUIRYLIST</a>
                            </li>
                        </ol>
                    </div>
                </nav>
                <div class="page-content">
                    <div class="container">
                    
                    <div class="distribute">
				    <!-- ÎãµÎ≥ÄÏôÑÎ£å Î≥¥Í∏∞ Î≤ÑÌäº -->
				    <a href="#" class="btn btn-filter" 
				       data-filter-type="status" data-filter-value="COMPLETED"
				       th:classappend="${param.status == 'COMPLETED' ? 'btn-success' : 'btn-primary'}">ÎãµÎ≥ÄÏôÑÎ£å Î≥¥Í∏∞</a>
				
				    <!-- ÎÇ¥ Î¨∏Ïùò Î≥¥Í∏∞ Î≤ÑÌäº (Î°úÍ∑∏Ïù∏ ÏãúÏóêÎßå Î≥¥ÏûÑ) -->
				    <a href="#" class="btn btn-filter"
				       data-filter-type="author" data-filter-value="me"
				       th:classappend="${param.author == 'me' ? 'btn-success' : 'btn-primary'}"
				       th:if="${session.loginUser != null}">ÎÇ¥ Î¨∏Ïùò Î≥¥Í∏∞</a>
				
				    <!-- Ï†ÑÏ≤¥ Î™©Î°ù Î≥¥Í∏∞ Î≤ÑÌäº -->
				    <a th:href="@{/customer/inquiry/inquiryList}" class="btn btn-primary">Ï†ÑÏ≤¥ Î™©Î°ù</a>
				
				    <!-- Î¨∏ÏùòÌïòÍ∏∞ Î≤ÑÌäº -->
				    <a th:href="@{/customer/inquiry/addInquiry}" class="btn btn-primary">Î¨∏ÏùòÌïòÍ∏∞</a>
				</div>
				                    
                    <!-- Í≤ÄÏÉâÏ∞Ω  -->           
                <div class="d-flex">
                    <!-- Í≤ÄÏÉâ Ìèº (ÏôºÏ™Ω) -->
                    <form th:action="@{/customer/inquiry/inquiryList}" method="get">
                        <div class="input-group">
                            <select name="searchType" class="form-control" style="flex: 0 0 10rem;">
                                <option value="title" th:selected="${param.searchType == 'title' or param.searchType == null}">Ï†úÎ™©</option>
                                <option value="content" th:selected="${param.searchType == 'content'}">ÎÇ¥Ïö©</option>
                                <!-- ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ Í≤ÄÏÉâ ÏòµÏÖò Ï∂îÍ∞Ä ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ -->
                                <option value="writer" th:selected="${param.searchType == 'writer'}">ÏûëÏÑ±Ïûê</option>
                                <option value="inquiryType" th:selected="${param.searchType == 'inquiryType'}">ÏßàÎ¨∏Ïú†Ìòï</option>
                            </select>
                            <input type="text" name="keyword" class="form-control" placeholder="Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" th:value="${param.keyword}" style="flex: 0 0 35rem;">
                            <div class="input-group-append">
                                <button class="btn btn-search" type="submit">Í≤ÄÏÉâ</button>
                            </div>
                        </div>
                    </form>

                  
                </div>
                    
                        <table class="table table-wishlist table-mobile">
                            <thead>
                                <tr class="center">
                                    <th scope="col">Î≤àÌò∏</th>
                                    <th scope="col">ÎπÑÎ∞ÄÍ∏Ä</th>
                                    <th scope="col">Ï†úÎ™©</th>
                                    <th scope="col">ÏûëÏÑ±Ïûê</th>
                                    <th scope="col">ÏßàÎ¨∏Ïú†Ìòï</th>
                                    <th scope="col">ÏÉÅÌÉú</th>
                                    <th scope="col">ÏûëÏÑ±Ïùº</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:if="${#lists.isEmpty(inquiryList)}">
                                    <td colspan="7" class="text-center">Îì±Î°ùÎêú Î¨∏ÏùòÍ∞Ä ÏóÜÏäµÎãàÎã§.</td>
                                </tr>
                                <tr th:unless="${#lists.isEmpty(inquiryList)}"
                                    th:each="l, i : ${inquiryList}">
                                    <td th:text="${totalRows - ((currentPage - 1) * pageSize + i.index)}"></td>
                                    <td th:text="${l.prvtYn ? 'üîí' : ''}"></td>
                                    <td>
                                        <a th:href="@{/customer/inquiry/inquiryDetail(inquiryId=${l.inqryId})}" th:text="${l.inqryTtl}"></a>
                                    </td>
                                    <td th:text="${l.writerInfo?.userNcnm}"></td>
                                    <td th:text="${l.inqryTypeCd}"></td>
                                    <td>
						                <th:block th:switch="${l.prcsStts}">
						                    <span th:case="'RECEPTION'" class="reception">Ï†ëÏàò</span>
						                    <span th:case="'COMPLETED'" class="completed">ÎãµÎ≥Ä ÏôÑÎ£å</span>
						                    <span th:case="*" th:text="${l.prcsStts}"></span>
						                </th:block>
						            </td>
                                    <td th:text="${#temporals.format(l.regYmd, 'yyyy-MM-dd')}" th:if="${l.regYmd != null}"></td>
                                </tr>
                            </tbody>
                        </table>

                         <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center">
                        <!-- Ïù¥Ï†Ñ Î≤ÑÌäº -->
                        <li class="page-item" th:classappend="${currentPage <= 1 ? 'disabled' : ''}">
                            <a class="page-link page-link-prev"
                               th:href="@{/customer/inquiry/inquiryList(page=${currentPage - 1}, size=${pageSize}, searchType=${param.searchType}, keyword=${param.keyword}, author=${param.author}, status=${param.status})}"
                               aria-label="Ïù¥Ï†Ñ"> <i class="icon-angle-left"></i> </a>
                        </li>
                        <!-- ÌéòÏù¥ÏßÄ Î≤àÌò∏ -->
                        <li class="page-item" th:each="pageNumber : ${#numbers.sequence(startPage, endPage)}" th:classappend="${pageNumber == currentPage ? 'active' : ''}">
                            <a class="page-link"
                               th:href="@{/customer/inquiry/inquiryList(page=${pageNumber}, size=${pageSize}, searchType=${param.searchType}, keyword=${param.keyword}, author=${param.author}, status=${param.status})}"
                               th:text="${pageNumber}"></a>
                        </li>
                        <!-- Îã§Ïùå Î≤ÑÌäº -->
                        <li class="page-item" th:classappend="${currentPage >= totalPages ? 'disabled' : ''}">
                            <a class="page-link page-link-next"
                               th:href="@{/customer/inquiry/inquiryList(page=${currentPage + 1}, size=${pageSize}, searchType=${param.searchType}, keyword=${param.keyword}, author=${param.author}, status=${param.status})}"
                               aria-label="Îã§Ïùå"> <i class="icon-angle-right"></i> </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </main>

        </th:block>

        <th:block layout:fragment="jsScript">
             <script th:inline="javascript">
    /*<![CDATA[*/
       $(document).ready(function() {
    const currentUrl = new URL(window.location.href);
    const params = new URLSearchParams(currentUrl.search);
    
    // --- ÌïÑÌÑ∞ Î≤ÑÌäº Í≥µÌÜµ Ïù¥Î≤§Ìä∏ Ï≤òÎ¶¨ ---
    // 'data-filter-type'Í≥º 'data-filter-value' ÏÜçÏÑ±ÏùÑ ÏÇ¨Ïö©ÌïòÏó¨ Ïñ¥Îñ§ ÌïÑÌÑ∞Î•º Ï†úÏñ¥Ìï†ÏßÄ Í≤∞Ï†ï
    $('.btn-filter').on('click', function(e) {
        e.preventDefault();

        const filterType = $(this).data('filter-type'); // 'status' ÎòêÎäî 'author'
        const filterValue = $(this).data('filter-value'); // 'COMPLETED' ÎòêÎäî 'me'

        // URLÏóê ÌååÎùºÎØ∏ÌÑ∞Í∞Ä Ïù¥ÎØ∏ ÏûàÏúºÎ©¥ ÏÇ≠Ï†ú(ÌÜ†Í∏Ä ÎÅÑÍ∏∞), ÏóÜÏúºÎ©¥ Ï∂îÍ∞Ä(ÌÜ†Í∏Ä ÏºúÍ∏∞)
        if (params.get(filterType) === filterValue) {
            params.delete(filterType);
        } else {
            params.set(filterType, filterValue);
        }
        
        params.set('page', '1'); // ÌïÑÌÑ∞ Î≥ÄÍ≤Ω Ïãú Ìï≠ÏÉÅ 1ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
        
        window.location.href = '/customer/inquiry/inquiryList?' + params.toString();
    });

    // --- ÏÑúÎ≤ÑÏóêÏÑú Ï†ÑÎã¨Îêú ÏóêÎü¨ Î©îÏãúÏßÄ Ï≤òÎ¶¨ ---
    var errorMessage = /*[[${errorMessage}]]*/ null;
    if (errorMessage) {
        alert(errorMessage);
    }

    console.log("Î¨∏Ïùò Í≤åÏãúÌåê Ïä§ÌÅ¨Î¶ΩÌä∏Í∞Ä Ï†ïÏÉÅÏ†ÅÏúºÎ°ú Ïã§ÌñâÎêòÏóàÏäµÎãàÎã§!");
});
    /*]]>*/
    </script>
        </th:block>
    </body>
</html>