<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{customer/layout/layoutMain}">

	<head>
	    <meta name="description" content="한국스마트정보교육원 ksmybatis" />
	    <title>게시글 목록</title>
	    <!-- CSS 파일 링크는 layoutMain에서 제공될 가능성이 높으므로, 여기에 다시 명시하지 않겠습니다. -->
	    <!-- 만약 layoutMain에서 CSS를 동적으로 추가하지 않는다면, 여기에 추가해야 합니다. -->
	    <link rel="stylesheet" th:href="@{/maincss/assets/customcustomercss/postList.css}">
	</head>
	
	<!-- 추가할 js file -->
	<th:block layout:fragment="jsFile">
	    <!-- 필요한 js 파일이 있다면 여기에 추가 -->
	    <script th:src="@{/maincss/assets/js/customer/postList.js}"></script>
	</th:block>
	
	
	<!-- 추가할 script -->
	<th:block layout:fragment="jsScript">
	
	</th:block>
	
	<!-- 추가할 페이지 contents -->
	<th:block layout:fragment="contents">
	    <!-- 사진 2처럼 페이지 타이틀이 나오는 부분을 가정하고 div로 감쌌습니다 -->
		<div class="container">
		    <div class="page-title-section">
		        <h2 th:text="${boardName}" class="page-main-title">게시판 이름</h2>
		        <h5 class="page-subtitle">게시판의 모든 게시글</h5>
		    </div>
		
			<!-- 카테고리 탭 -->
			<div class="board-tabs-container"  id="tabsContainer">
				<ul class="nav nav-tabs">
					<li class="nav-item">
						<a	class="nav-link"
							th:href="@{/customer/post/postList}"
							th:classappend="${bbsClsfCd == null || bbsClsfCd == '' ? 'active' : ''}">전체</a>
					</li>
	
					<li class="nav-item" th:each="b : ${boardList}">
						<a	class="nav-link"
							th:href="@{/customer/post/postList(bbsClsfCd=${b.bbsClsfCd})}"
							th:text="${b.bbsNm}"
							th:classappend="${bbsClsfCd == b.bbsClsfCd ? 'active' : ''}">게시판 이름</a>
					</li>
				</ul>
			</div>
			
		    <div class="card mb-4">
		        <!-- card-header end// -->
		        <div class="card-body">
		            <div class="table-responsive">
		                <table class="table table-hover">
		                    <thead>
		                        <tr>
									<th style="width: 15%;">게시글일련번호</th>
									<th style="width: 40%;">게시글제목</th>
									<th style="width: 15%;">작성자</th>
									<th style="width: 8%;">추천수</th>
									<th style="width: 8%;">조회수</th>
									<th style="width: 14%;">생성일시</th>
		                        </tr>
		                    </thead>
		                    <tbody>
		                        <th:block th:if="${!#lists.isEmpty(postList)}">
		                            <tr th:each="p : ${postList}">
		                                <td th:text="${p.pstSn}">게시글일련번호</td>
		                                <td class="post-title-cell"> <!-- 제목 셀에 클래스 추가 -->
		                                    <a th:text="${p.pstTtl}"
		                                       th:href="@{/customer/post/postView(pstSn=${p.pstSn}, bbsClsfCd=${bbsClsfCd}, page=${currentPage}, size=${size})}"
		                                       class="post-title-link">게시글제목</a>
		                                    <span th:if="${p.cmntCnt > 0}">
		                                    	[<span th:text="${p.cmntCnt}"></span>]
		                                    </span>
		                                </td>
		                                <td th:text="${p.userInfo.userNcnm}">작성자</td>
		                                <td th:text="${p.interCnt}">추천수</td>
		                                <td th:text="${p.viewCnt}">조회수</td>
		                                <td th:text="${ #temporals.format(p.crtDt, 'yyyy-MM-dd') == #temporals.format(#temporals.createNow(), 'yyyy-MM-dd') 
													? #temporals.format(p.crtDt, 'HH:mm') 
													: #temporals.format(p.crtDt, 'MM-dd') }">생성일시</td>
		                            </tr>
		                        </th:block>
		                        <tr th:unless="${!#lists.isEmpty(postList)}">
		                            <td colspan="5">게시글이 존재하지 않습니다.</td> <!-- colspan은 테이블 헤더 개수에 맞게 조정 -->
		                        </tr>
		                    </tbody>
		                </table>
		            </div>
		            <!-- table-responsive //end -->
		        </div>
		        <!-- card-body end// -->
		
		        <div class="content-footer-action">
		            <button type="button" class="btn-write-post" th:onclick="location.href='/customer/post/postWrite'">글 작성</button>
		        </div>
	
		    </div>
		    <!-- card end// -->
		
		    <!-- 페이지네이션 영역 -->
		    <div class="pagination-area">
				<!-- 페이지네이션 바 (수정 후 예시) -->
				<nav aria-label="Page navigation">
				    <ul class="pagination justify-content-center">
				        
				        <!-- '이전' 버튼: 현재 페이지가 1보다 클 때만 보임 -->
				        <li class="page-item" th:if="${currentPage > 1}">
				            <a class="page-link" th:href="@{/customer/post/postList(page=${currentPage-1}, size=${size}, bbsClsfCd=${bbsClsfCd})}">이전</a>
				        </li>
				
				        <!-- 페이지 번호 목록: startPageNum부터 endPageNum까지 반복 -->
				        <!-- th:each를 사용하여 계산된 범위만큼만 페이지 번호를 생성합니다. -->
				        <th:block th:each="pageNum : ${#numbers.sequence(startPageNum, endPageNum)}">
				            <li class="page-item" th:classappend="${pageNum == currentPage} ? 'active' : ''">
				                <a class="page-link" th:href="@{/customer/post/postList(page=${pageNum}, size=${size}, bbsClsfCd=${bbsClsfCd})}" th:text="${pageNum}">1</a>
				            </li>
				        </th:block>
				
				        <!-- '다음' 버튼: 현재 페이지가 마지막 페이지(totalPage)보다 작을 때만 보임 -->
				        <li class="page-item" th:if="${currentPage < totalPage}">
				            <a class="page-link" th:href="@{/customer/post/postList(page=${currentPage+1}, size=${size}, bbsClsfCd=${bbsClsfCd})}">다음</a>
				        </li>
				
				    </ul>
				</nav>
		    </div>
			<!-- =================================================================== -->
			<!-- 임시 검색 및 페이지 크기 조절 컨트롤 (부트스트랩 기반) -->
			<!-- =================================================================== -->
			<div class="container mt-4">
			    <!-- form 태그로 전체를 감싸서 검색과 페이지 크기 변경이 모두 작동하게 합니다. -->
			    <form th:action="@{/customer/post/postList}" method="GET" id="tempSearchAndSizeForm">
			        
			        <!-- 부트스트랩의 'row'를 사용하여 컨트롤들을 한 줄에 배치합니다. -->
			        <div class="row justify-content-between align-items-center">
			
			            <!-- 1. 검색창 영역 (화면의 약 7칸 차지) -->
			            <div class="col-md-7">
			                <!-- 'input-group'은 검색창과 버튼을 예쁘게 묶어주는 부트스트랩 기능입니다. -->
			                <div class="input-group">
			                    <input type="text" 
			                           name="keyword" 
			                           class="form-control" 
			                           placeholder="검색어를 입력하세요" 
			                           th:value="${param.keyword}"
			                           aria-label="검색어 입력">
			                    <button class="btn btn-outline-secondary" type="submit">검색</button>
			                </div>
			            </div>
			
			            <!-- 2. 페이지 사이즈 선택 영역 (화면의 약 4칸 차지) -->
			            <div class="col-md-4">
			                <!-- 'd-flex'와 'justify-content-end'로 내용물을 오른쪽 끝으로 정렬합니다. -->
			                <div class="d-flex justify-content-end align-items-center">
			                    <label for="tempPageSizeSelect" class="form-label mb-0 me-2">개수:</label>
			                    <select id="tempPageSizeSelect" 
			                            name="size" 
			                            class="form-select form-select-sm" 
			                            style="width: auto;" 
			                            onchange="document.getElementById('tempSearchAndSizeForm').submit()">
			                        <option value="10" th:selected="${size == 10}">10개</option>
			                        <option value="15" th:selected="${size == 15}">15개</option>
			                        <option value="20" th:selected="${size == 20}">20개</option>
			                    </select>
			                </div>
			            </div>
			
			        </div>
			    </form>
			</div>
			<!-- =================================================================== -->
			<!-- 임시 컨트롤 끝 -->
			<!-- =================================================================== -->
	
		    
		</div>
	</th:block>

</html>