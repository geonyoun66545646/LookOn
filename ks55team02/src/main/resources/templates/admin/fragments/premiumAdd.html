<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org/"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/layout/layoutMain}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관리자 - 구독권 등록</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="maincss/assets/customcustomercss/premiumAdd.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
<th:block layout:fragment="contents">
    <div class="page-container">
        <h1 class="page-title">구독 플랜 등록</h1>
        <p class="page-subtitle">판매자가 구매할 수 있는 새로운 구독 플랜을 등록합니다.</p>

        <div class="content-wrapper">
            <div class="subscription-form-panel">
                <h2 class="panel-title">새 구독 플랜 정보</h2>
                
                <!-- 폼의 action과 method를 컨트롤러의 POST 엔드포인트에 맞춥니다. -->
                <form id="add-subscription-form" th:action="@{/admin/premiumadd/new}" method="post">
                    <div class="form-group">
                        <label for="sbscr-plan-nm">구독 플랜명</label>
                        <!-- name 속성을 DTO 필드명(sbscrPlanNm)과 일치시킵니다. -->
                        <input type="text" id="sbscr-plan-nm" name="sbscrPlanNm" placeholder="예: 프리미엄 구독 코인" required>
                    </div>

                    <div class="form-group">
                        <label for="sbscr-plan-term-val">구독 기간 (일)</label>
                        <!-- name 속성을 DTO 필드명(sbscrPlanTermVal)과 일치시킵니다. -->
                        <input type="number" id="sbscr-plan-term-val" name="sbscrPlanTermVal" min="1" value="30" required>
                    </div>

                    <div class="form-group">
                        <label for="sbscr-plan-prc">가격 (원)</label>
                        <!-- name 속성을 DTO 필드명(sbscrPlanPrc)과 일치시킵니다. -->
                        <input type="number" id="sbscr-plan-prc" name="sbscrPlanPrc" min="0" value="2990000" required>
                    </div>

                    <div class="form-group">
                        <label for="sbscr-plan-expln">설명</label>
                        <!-- name 속성을 DTO 필드명(sbscrPlanExpln)과 일치시킵니다. -->
                        <textarea id="sbscr-plan-expln" name="sbscrPlanExpln" rows="4" placeholder="구독 플랜에 대한 자세한 설명을 입력하세요." required></textarea>
                    </div>

                    <button type="submit" class="submit-button">구독 플랜 등록하기</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('add-subscription-form');

            form.addEventListener('submit', (event) => {
                // 필수 필드 유효성 검사 (클라이언트 측)
                const sbscrPlanNm = document.getElementById('sbscr-plan-nm').value;
                const sbscrPlanTermVal = document.getElementById('sbscr-plan-term-val').value;
                const sbscrPlanPrc = document.getElementById('sbscr-plan-prc').value;
                const sbscrPlanExpln = document.getElementById('sbscr-plan-expln').value;

                if (!sbscrPlanNm || !sbscrPlanTermVal || !sbscrPlanPrc || !sbscrPlanExpln) {
                    alert('모든 필드를 입력해주세요.');
                    event.preventDefault(); // 제출 방지
                    return;
                }

                // **여기서 event.preventDefault()를 제거하지 않습니다.**
                // **대신, 폼이 유효성 검사를 통과하면 자연스럽게 서버로 제출되도록 둡니다.**
                // **이전에 있었던 클라이언트 측 alert()와 폼 초기화 로직은 서버 응답에 따라 처리되므로 제거합니다.**

                console.log('폼 제출 준비 완료. 서버로 전송됩니다.');
                // 폼은 이제 th:action에 지정된 URL로 일반적인 POST 요청을 보냅니다.
                // 서버로부터의 응답(리다이렉트)은 브라우저가 처리합니다.
                // 따라서 여기에 추가적인 JavaScript 로직 (alert, form.reset() 등)은 필요 없습니다.
                // 서버에서 리다이렉트 시 Flash Attribute로 메시지를 전달할 것입니다.
            });
        });
    </script>
</th:block>    
</body>
</html>
