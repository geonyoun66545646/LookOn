<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{admin/layout/layoutMain}">

<head>
<title>신고 목록 조회</title>
</head>

<th:block layout:fragment="contents">
	<main class="main-content">
		<section class="content-header">
			<h2 class="content-title">신고 목록 조회</h2>
			<div></div>
		</section>

		<div class="card mb-4">
			<div class="card-body">
				<form id="reportSearchForm" action="#" method="get">
					<div class="row gx-3 align-items-end">

						<div class="col-lg-4 mb-3">
							<label class="form-label">접수 기간</label>
							<div class="d-flex">
								<input type="date" class="form-control" name="startDate"
									value="2023-01-01"> <span
									class="mx-2 d-flex align-items-center">~</span> <input
									type="date" class="form-control" name="endDate"
									value="2023-12-31">
							</div>
						</div>

						<div class="col-lg-4 mb-3">
							<label class="form-label">검색 키워드</label>
							<div class="input-group">
								<select class="form-select" name="searchKey"
									style="max-width: 150px;">
									<option value="all" selected>전체</option>
									<option value="dclrId">신고 ID</option>
									<option value="dclrUserNo">신고자 ID</option>
									<option value="dclrTrgtUserNo">대상 사용자 ID</option>
									<option value="dclrTrgtContsId">대상 콘텐츠 ID</option>
								</select> <input type="text" class="form-control" name="searchValue"
									value="" placeholder="신고 ID, 사용자 ID, 콘텐츠 ID">
							</div>
						</div>

						<div class="col-lg-2 mb-3">
							<label for="prcsSttsCd" class="form-label">처리 상태</label> <select
								class="form-select" id="prcsSttsCd" name="prcsSttsCd">
								<option value="">-- 전체 --</option>
								<option value="PENDING" selected>처리 대기</option>
								<option value="IN_PROGRESS">처리 중</option>
								<option value="COMPLETED">처리 완료</option>
								<option value="REJECTED">반려</option>
							</select>
						</div>

						<div class="col-lg-2 mb-3 d-flex align-items-end">
							<a href="#" class="btn btn-primary btn-block me-2" id="searchBtn">검색</a>
							<button class="btn btn-light btn-block" type="reset">초기화</button>
						</div>
					</div>
				</form>
			</div>
		</div>

		<div class="card">
			<div class="card-body">
				<div class="d-flex justify-content-between align-items-center mb-3">
					<div>
						<span class="font-weight-bold">[ 전체 신고 <span
							class="text-primary" th:text="${pagination.totalRecordCount}">0</span>건
							]
						</span>
					</div>
					<div></div>
				</div>

				<table class="table table-hover text-center">
					<thead class="thead-light">
						<tr>
							<th><div class="form-check">
									<input class="form-check-input" type="checkbox"
										id="checkAllRows">
								</div></th>
							<th>신고 ID</th>
							<th>신고 일시</th>
							<th>신고자 ID</th>
							<th>대상 타입</th>
							<th>대상 ID</th>
							<th>신고 사유</th>
							<th>상세 사유 요약</th>
							<th>처리 상태</th>
							<th>관리</th>
						</tr>
					</thead>
					<tbody th:with="reportList=${reportList}">
						<tr th:if="${#lists.isEmpty(reportList)}">
							<td colspan="10" class="text-center py-5">조회된 신고 내역이 없습니다.</td>
						</tr>

						<tr th:unless="${#lists.isEmpty(reportList)}"
							th:each="report : ${reportList}">
							<td>
								<div class="form-check">
									<input class="form-check-input" type="checkbox"
										th:value="${report.dclrId}">
								</div>
							</td>
							<td th:text="${report.dclrId}">DCLR_20230710_001</td>
							<td
								th:text="${#temporals.format(report.dclrRcptDt, 'yyyy-MM-dd HH:mm')}">2023-07-10
								10:30</td>
							<td th:text="${report.dclrUserNickname}">user_honggildong</td>
							<td th:text="${report.dclrTrgtTypeCd}">USER</td>
							<td th:text="${report.intelligentTargetInfo}">user_badguy</td>
							<td th:text="${report.dclrReasonContent}">욕설/비방</td>
							<td class="text-truncate" style="max-width: 150px;"
								th:text="${report.dtlDclrRsnCn}">게시글에 반복적인 욕설 사용...</td>

							<td><span th:switch="${report.prcsSttsCd}"
								th:classappend="${report.prcsSttsCd == 'PENDING'} ? 'bg-warning' : (${report.prcsSttsCd == 'COMPLETED'} ? 'bg-success' : 'bg-info')"
								class="badge"> <span th:case="'PENDING'">처리 대기</span> <span
									th:case="'COMPLETED'">처리 완료</span> <span th:case="'REJECTED'">반려</span>
									<span th:case="*">처리 중</span>
							</span></td>

							<td><a
								th:href="@{/adminpage/inquiryadmin/reports/{dclrId}(dclrId=${report.dclrId})}"
								class="btn btn-sm btn-primary" style="min-width: 90px;"
								th:text="${report.prcsSttsCd == 'COMPLETED' or report.prcsSttsCd == 'REJECTED'} ? '상세' : '처리'">
									처리 </a></td>
						</tr>
					</tbody>
				</table>

				<nav class="d-flex justify-content-center mt-4"
					aria-label="Page navigation"
					th:if="${pagination.totalRecordCount > 0}">
					<ul class="pagination">
						<li class="page-item"
							th:classappend="${!pagination.existPrevBlock} ? 'disabled'">
							<a class="page-link"
							th:href="@{/adminpage/inquiryadmin/reports(currentPage=${pagination.startPage - 1}, searchKey=${param.searchKey}, searchValue=${param.searchValue})}">이전</a>
						</li>

						<li class="page-item"
							th:each="page : ${#numbers.sequence(pagination.startPage, pagination.endPage)}"
							th:classappend="${page == pagination.currentPage} ? 'active'">
							<a class="page-link" th:text="${page}"
							th:href="@{/adminpage/inquiryadmin/reports(currentPage=${page}, searchKey=${param.searchKey}, searchValue=${param.searchValue})}"></a>
						</li>

						<li class="page-item"
							th:classappend="${!pagination.existNextBlock} ? 'disabled'">
							<a class="page-link"
							th:href="@{/adminpage/inquiryadmin/reports(currentPage=${pagination.endPage + 1}, searchKey=${param.searchKey}, searchValue=${param.searchValue})}">다음</a>
						</li>
					</ul>
				</nav>
			</div>
		</div>
	</main>
</th:block>

<th:block layout:fragment="jsScript">

</th:block>
</html>